<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mati</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #6c5ce7;
            --dark: #2d3436;
            --light: #f5f6fa;
            --accent: #fd79a8;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--light);
            color: var(--dark);
            transition: all 0.5s ease;
            min-height: 100vh;
        }
        
        body.dark-mode {
            background-color: var(--dark);
            color: var(--light);
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        h1 {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 30px;
            position: relative;
        }
        
        h1::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 25%;
            width: 50%;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            border-radius: 3px;
        }
        
        .menu-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-top: 40px;
        }
        
        .menu-button {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 20px 25px;
            border: none;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--primary), #a29bfe);
            color: white;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(108, 92, 231, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .menu-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: 0.5s;
        }
        
        .menu-button:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(108, 92, 231, 0.5);
        }
        
        .menu-button:hover::before {
            left: 100%;
        }
        
        .page {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .back-button {
            background: var(--dark);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .back-button:hover {
            background: #444;
        }
        
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--dark);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }
        
        .trail-dot {
            position: fixed;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: radial-gradient(circle, var(--accent), transparent 70%);
            pointer-events: none;
            transform: translate(-50%, -50%);
            opacity: 0.7;
            transition: opacity 0.3s, transform 0.2s;
            z-index: 99;
        }
        
        .tiles-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .project-tile {
            background: white;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s;
            border-left: 4px solid var(--primary);
            cursor: pointer;
        }
        
        body.dark-mode .project-tile {
            background: #3a3a3a;
            color: white;
        }
        
        .project-tile:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.15);
        }
        
        .project-title {
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 8px;
        }
        
        .project-status {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            margin-top: 5px;
        }
        
        .status-active {
            background: #00b894;
            color: white;
        }
        
        .status-planned {
            background: #fdcb6e;
            color: var(--dark);
        }
        
        .status-completed {
            background: #6c5ce7;
            color: white;
        }
        
        .controls {
            display: flex;
            gap: 10px;
            margin: 20px 0;
        }
        
        .search-input {
            flex: 1;
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
        }
        
        body.dark-mode .search-input {
            background: #444;
            color: white;
            border-color: #666;
        }
        
        .search-button {
            background: var(--primary);
            color: white;
            border: none;
            width: 40px;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .search-button:hover {
            background: #5649d6;
        }
        
        .flats-container {
            margin-top: 30px;
        }
        
        .floor-section {
            margin-bottom: 30px;
            border-bottom: 1px solid #ddd;
            padding-bottom: 15px;
        }
        
        .floor-title {
            font-size: 1.3rem;
            color: var(--primary);
            margin-bottom: 15px;
            padding: 5px 10px;
            background: rgba(108, 92, 231, 0.1);
            border-radius: 6px;
            display: inline-block;
        }
        
        .flats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .flat-tile {
            padding: 12px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        
        .flat-tile:hover {
            transform: translateY(-3px);
        }
        
        .flat-status-sold {
            background: #ff7675;
            color: white;
        }
        
        .flat-status-available {
            background: #55efc4;
            color: var(--dark);
        }
        
        .flat-status-reserved {
            background: #ffeaa7;
            color: var(--dark);
        }
        
        .flat-info {
            margin: 5px 0;
            font-size: 0.9rem;
        }
        
        .realtors-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .realtor-card {
            background: white;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        body.dark-mode .realtor-card {
            background: #3a3a3a;
        }
        
        .realtor-name {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--primary);
        }
        
        .realtor-phone {
            margin: 8px 0;
        }
        
        .realtor-deals {
            margin-top: 10px;
            font-size: 0.9rem;
        }
        
        .deal-item {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
            padding-bottom: 5px;
            border-bottom: 1px dashed #ddd;
        }
        
        .clients-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .client-button {
            background: white;
            border: none;
            border-radius: 8px;
            padding: 15px;
            text-align: left;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }
        
        body.dark-mode .client-button {
            background: #3a3a3a;
        }
        
        .client-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .client-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .client-phone {
            font-size: 0.9rem;
            color: #666;
        }
        
        body.dark-mode .client-phone {
            color: #aaa;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        
        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 25px;
            border-radius: 10px;
            width: 80%;
            max-width: 600px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
        }
        
        body.dark-mode .modal-content {
            background-color: #3a3a3a;
            color: white;
        }
        
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .close:hover {
            color: #777;
        }
        
        .client-info {
            margin: 15px 0;
        }
        
        #clientNotes {
            width: 100%;
            height: 150px;
            padding: 10px;
            margin: 10px 0;
            border-radius: 6px;
            border: 1px solid #ddd;
            resize: none;
        }
        
        body.dark-mode #clientNotes {
            background: #444;
            color: white;
            border-color: #666;
        }
        
        .save-button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .save-button:hover {
            background: #5649d6;
        }
        
        .gallery-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .gallery-button {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .gallery-button:hover {
            background: #5649d6;
            transform: translateY(-3px);
        }
        
        .gallery-content {
            margin-top: 20px;
        }
        
        .media-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .media-item {
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
        }
        
        .media-item img, .media-item video {
            width: 100%;
            height: auto;
            display: block;
        }
        
        @media (max-width: 768px) {
            .realtors-container {
                grid-template-columns: 1fr;
            }
            
            .flats-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
            
            .modal-content {
                width: 90%;
                margin: 10% auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <button class="theme-toggle" id="themeToggle">
            <i class="fas fa-moon"></i>
        </button>
        
        <h1>Mati</h1>
        
        <div id="mainMenu">
            <div class="menu-container">
                <button class="menu-button" onclick="showPage('chess')">
                    <i class="fas fa-chess-rook"></i> Шахматки ЖК
                </button>
                <button class="menu-button" onclick="showPage('realtors')">
                    <i class="fas fa-user-tie"></i> Риэлторы
                </button>
                <button class="menu-button" onclick="showPage('clients')">
                    <i class="fas fa-users"></i> Клиенты
                </button>
                <button class="menu-button" onclick="showPage('gallery')">
                    <i class="fas fa-images"></i> Галерея
                </button>
            </div>
        </div>
        
        <div id="chess" class="page">
            <button class="back-button" onclick="showMainMenu()">
                <i class="fas fa-arrow-left"></i> Назад
            </button>
            <h2>Шахматки ЖК</h2>
            
            <div class="controls">
                <input type="text" id="searchInput" placeholder="Поиск ЖК..." class="search-input">
                <button onclick="filterProjects()" class="search-button">
                    <i class="fas fa-search"></i>
                </button>
            </div>
            
            <div class="tiles-container" id="projectsContainer"></div>
            
            <div id="flatsContainer" class="flats-container" style="display:none;">
                <button class="back-button" onclick="hideFlats()">
                    <i class="fas fa-arrow-left"></i> Назад к ЖК
                </button>
                <h3 id="currentBuildingTitle"></h3>
                <div class="floors-container" id="floorsContainer"></div>
            </div>
        </div>
        
        <div id="realtors" class="page">
            <button class="back-button" onclick="showMainMenu()">
                <i class="fas fa-arrow-left"></i> Назад
            </button>
            <h2>Риэлторы</h2>
            
            <div class="controls">
                <input type="text" id="realtorSearch" placeholder="Поиск риэлтора..." class="search-input">
                <button onclick="filterRealtors()" class="search-button">
                    <i class="fas fa-search"></i>
                </button>
            </div>
            
            <div class="realtors-container" id="realtorsContainer"></div>
        </div>
        
        <div id="clients" class="page">
            <button class="back-button" onclick="showMainMenu()">
                <i class="fas fa-arrow-left"></i> Назад
            </button>
            <h2>Клиенты</h2>
            
            <div class="controls">
                <input type="text" id="clientSearch" placeholder="Поиск клиента..." class="search-input">
                <button onclick="filterClients()" class="search-button">
                    <i class="fas fa-search"></i>
                </button>
            </div>
            
            <div class="clients-container" id="clientsContainer"></div>
            
            <div id="clientModal" class="modal">
                <div class="modal-content">
                    <span class="close" onclick="closeModal()">&times;</span>
                    <h3 id="modalClientName"></h3>
                    <div class="client-info">
                        <p><strong>Телефон:</strong> <span id="modalClientPhone"></span></p>
                        <p><strong>Последний контакт:</strong> <span id="modalClientLastContact"></span></p>
                    </div>
                    <textarea id="clientNotes" placeholder="Заметки о клиенте..."></textarea>
                    <button onclick="saveClientNotes()" class="save-button">Сохранить</button>
                </div>
            </div>
        </div>
        
        <div id="gallery" class="page">
            <button class="back-button" onclick="showMainMenu()">
                <i class="fas fa-arrow-left"></i> Назад
            </button>
            <h2>Галерея</h2>
            
            <div class="gallery-buttons" id="galleryButtons"></div>
            
            <div id="galleryContent" class="gallery-content" style="display:none;">
                <button class="back-button" onclick="hideGalleryContent()">
                    <i class="fas fa-arrow-left"></i> Назад
                </button>
                <h3 id="galleryBuildingTitle"></h3>
                <div class="media-container" id="mediaContainer"></div>
            </div>
        </div>
    </div>

    <script>
        // Основные данные
        let currentBuildingId = null;
        let currentClientId = null;
        let currentGalleryBuilding = null;

        // Данные ЖК
        const projectsData = [
            { 
                id: 1, 
                name: "ЖК Северное Сияние", 
                status: "active", 
                address: "ул. Ленина, 15", 
                progress: "75%",
                flats: [
                    { floor: 1, number: "101", area: 45, price: 120000, status: "available" },
                    { floor: 1, number: "102", area: 50, price: 125000, status: "sold" },
                    { floor: 2, number: "201", area: 60, price: 135000, status: "reserved" },
                    { floor: 2, number: "202", area: 55, price: 130000, status: "available" }
                ]
            },
            { 
                id: 2, 
                name: "ЖК Центральный", 
                status: "completed", 
                address: "пр. Мира, 42", 
                progress: "100%",
                flats: [
                    { floor: 1, number: "101", area: 48, price: 140000, status: "sold" },
                    { floor: 1, number: "102", area: 52, price: 145000, status: "sold" },
                    { floor: 2, number: "201", area: 65, price: 155000, status: "sold" }
                ]
            }
        ];

        // Данные риэлторов
        const realtorsData = [
            {
                id: 1,
                name: "Иванов Иван Иванович",
                phone: "+7 (123) 456-78-90",
                deals: [
                    { date: "15.05.2023", object: "ЖК Северное Сияние, кв. 102", sum: "6 250 000 ₽" },
                    { date: "22.06.2023", object: "ЖК Центральный, кв. 201", sum: "10 075 000 ₽" }
                ]
            },
            {
                id: 2,
                name: "Петрова Анна Сергеевна",
                phone: "+7 (987) 654-32-10",
                deals: [
                    { date: "10.04.2023", object: "ЖК Северное Сияние, кв. 101", sum: "5 400 000 ₽" }
                ]
            }
        ];

        // Данные клиентов
        const clientsData = [
            {
                id: 1,
                name: "Смирнов Алексей Владимирович",
                phone: "+7 (111) 222-33-44",
                lastContact: "20.06.2023",
                notes: "Интересуется 2-комнатными квартирами в центре"
            },
            {
                id: 2,
                name: "Кузнецова Елена Петровна",
                phone: "+7 (555) 666-77-88",
                lastContact: "15.07.2023",
                notes: "Рассматривает варианты с отделкой"
            }
        ];

        // Данные галереи
        const galleryData = [
            {
                id: 1,
                name: "ЖК Северное Сияние",
                media: [
                    { type: "image", url: "https://via.placeholder.com/600x400?text=Фасад+ЖК+Северное+Сияние", title: "Фасад здания" },
                    { type: "image", url: "https://via.placeholder.com/600x400?text=Вид+из+окна", title: "Вид из окна" },
                    { type: "video", url: "https://samplelib.com/lib/preview/mp4/sample-5s.mp4", title: "Видео обзор" }
                ]
            },
            {
                id: 2,
                name: "ЖК Центральный",
                media: [
                    { type: "image", url: "https://via.placeholder.com/600x400?text=Входная+группа", title: "Входная группа" },
                    { type: "image", url: "https://via.placeholder.com/600x400?text=Дворовая+территория", title: "Дворовая территория" }
                ]
            }
        ];

        // Основные функции
        function showPage(pageId) {
            document.getElementById('mainMenu').style.display = 'none';
            document.getElementById(pageId).style.display = 'block';
            
            if (pageId === 'chess') {
                renderProjects(projectsData);
            } else if (pageId === 'realtors') {
                renderRealtors(realtorsData);
            } else if (pageId === 'clients') {
                renderClients(clientsData);
            } else if (pageId === 'gallery') {
                renderGalleryButtons();
            }
        }

        function showMainMenu() {
            document.querySelectorAll('.page').forEach(page => {
                page.style.display = 'none';
            });
            document.getElementById('mainMenu').style.display = 'block';
        }

        // Тёмная тема
        const themeToggle = document.getElementById('themeToggle');
        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            themeToggle.innerHTML = document.body.classList.contains('dark-mode') 
                ? '<i class="fas fa-sun"></i>' 
                : '<i class="fas fa-moon"></i>';
        });

        // Шлейф курсора
        const buttons = document.querySelectorAll('.menu-button, .back-button, .search-button, .client-button, .gallery-button, .save-button');

        buttons.forEach(button => {
            button.addEventListener('mouseenter', () => {
                createCursorTrailEffect(button);
            });
        });

        function createCursorTrailEffect(element) {
            let dots = [];
            
            element.addEventListener('mousemove', (e) => {
                const dot = document.createElement('div');
                dot.className = 'trail-dot';
                dot.style.left = e.clientX + 'px';
                dot.style.top = e.clientY + 'px';
                document.body.appendChild(dot);
                
                dots.push(dot);
                
                setTimeout(() => {
                    dot.style.opacity = '0';
                    setTimeout(() => dot.remove(), 300);
                }, 500);
            });
            
            element.addEventListener('mouseleave', () => {
                dots.forEach(dot => {
                    dot.style.opacity = '0';
                    setTimeout(() => dot.remove(), 300);
                });
                dots = [];
            });
        }

        // ===== РАЗДЕЛ "ШАХМАТКИ ЖК" =====
        function renderProjects(projects) {
            const container = document.getElementById('projectsContainer');
            container.innerHTML = '';
            
            projects.forEach(project => {
                const tile = document.createElement('div');
                tile.className = 'project-tile';
                
                let statusClass = '';
                let statusText = '';
                
                switch(project.status) {
                    case 'active': 
                        statusClass = 'status-active';
                        statusText = 'В работе';
                        break;
                    case 'completed':
                        statusClass = 'status-completed';
                        statusText = 'Завершён';
                        break;
                    default:
                        statusClass = 'status-planned';
                        statusText = 'Планируется';
                }
                
                tile.innerHTML = `
                    <div class="project-title">${project.name}</div>
                    <div><small>Адрес:</small> ${project.address}</div>
                    <div><small>Готовность:</small> ${project.progress}</div>
                    <div class="project-status ${statusClass}">${statusText}</div>
                `;
                
                tile.addEventListener('click', () => showFlats(project));
                container.appendChild(tile);
            });
        }

        function showFlats(project) {
            currentBuildingId = project.id;
            document.getElementById('projectsContainer').style.display = 'none';
            document.getElementById('flatsContainer').style.display = 'block';
            document.getElementById('currentBuildingTitle').textContent = project.name;
            
            const floorsContainer = document.getElementById('floorsContainer');
            floorsContainer.innerHTML = '';
            
            // Группируем квартиры по этажам
            const floors = {};
            project.flats.forEach(flat => {
                if (!floors[flat.floor]) {
                    floors[flat.floor] = [];
                }
                floors[flat.floor].push(flat);
            });
            
            // Сортируем этажи и рендерим
            Object.keys(floors).sort().forEach(floor => {
                const floorSection = document.createElement('div');
                floorSection.className = 'floor-section';
                
                const floorTitle = document.createElement('h4');
                floorTitle.className = 'floor-title';
                floorTitle.textContent = `Этаж ${floor}`;
                floorSection.appendChild(floorTitle);
                
                const flatsGrid = document.createElement('div');
                flatsGrid.className = 'flats-grid';
                
                floors[floor].forEach(flat => {
                    const flatTile = document.createElement('div');
                    flatTile.className = `flat-tile flat-status-${flat.status}`;
                    
                    let statusText = '';
                    switch(flat.status) {
                        case 'sold': statusText = 'Продано'; break;
                        case 'available': statusText = 'Свободна'; break;
                        case 'reserved': statusText = 'Бронь'; break;
                    }
                    
                    flatTile.innerHTML = `
                        <div class="flat-info"><strong>Кв. ${flat.number}</strong></div>
                        <div class="flat-info">Площадь: ${flat.area} м²</div>
                        <div class="flat-info">Цена: ${(flat.area * flat.price).toLocaleString()} ₽</div>
                        <div class="flat-info">(${flat.price.toLocaleString()} ₽/м²)</div>
                        <div class="flat-info"><strong>${statusText}</strong></div>
                    `;
                    
                    flatsGrid.appendChild(flatTile);
                });
                
                floorSection.appendChild(flatsGrid);
                floorsContainer.appendChild(floorSection);
            });
        }

        function hideFlats() {
            document.getElementById('flatsContainer').style.display = 'none';
            document.getElementById('projectsContainer').style.display = 'grid';
        }

        function filterProjects() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const filtered = projectsData.filter(project => 
                project.name.toLowerCase().includes(searchTerm) || 
                project.address.toLowerCase().includes(searchTerm)
            );
            renderProjects(filtered);
        }

        // ===== РАЗДЕЛ "РИЭЛТОРЫ" =====
        function renderRealtors(realtors) {
            const container = document.getElementById('realtorsContainer');
            container.innerHTML = '';
            
            realtors.forEach(realtor => {
                const card = document.createElement('div');
                card.className = 'realtor-card';
                
                let dealsHtml = '';
                if (realtor.deals && realtor.deals.length > 0) {
                    dealsHtml = '<div class="realtor-deals"><strong>Сделки:</strong>';
                    realtor.deals.forEach(deal => {
                        dealsHtml += `
                            <div class="deal-item">
                                <span>${deal.date}</span>
                                <span>${deal.sum}</span>
                            </div>
                            <div>${deal.object}</div>
                        `;
                    });
                    dealsHtml += '</div>';
                }
                
                card.innerHTML = `
                    <div class="realtor-name">${realtor.name}</div>
                    <div class="realtor-phone"><i class="fas fa-phone"></i> ${realtor.phone}</div>
                    ${dealsHtml}
                `;
                
                container.appendChild(card);
            });
        }

        function filterRealtors() {
            const searchTerm = document.getElementById('realtorSearch').value.toLowerCase();
            const filtered = realtorsData.filter(realtor => 
                realtor.name.toLowerCase().includes(searchTerm) || 
                realtor.phone.toLowerCase().includes(searchTerm)
            );
            renderRealtors(filtered);
        }

        // ===== РАЗДЕЛ "КЛИЕНТЫ" =====
        function renderClients(clients) {
            const container = document.getElementById('clientsContainer');
            container.innerHTML = '';
            
            clients.forEach(client => {
                const button = document.createElement('button');
                button.className = 'client-button';
                
                button.innerHTML = `
                    <div class="client-name">${client.name}</div>
                    <div class="client-phone">${client.phone}</div>
                `;
                
                button.addEventListener('click', () => openClientModal(client));
                container.appendChild(button);
            });
        }

        function openClientModal(client) {
            currentClientId = client.id;
            document.getElementById('modalClientName').textContent = client.name;
            document.getElementById('modalClientPhone').textContent = client.phone;
            document.getElementById('modalClientLastContact').textContent = client.lastContact || 'нет данных';
            document.getElementById('clientNotes').value = client.notes || '';
            
            document.getElementById('clientModal').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('clientModal').style.display = 'none';
        }

        function saveClientNotes() {
            if (currentClientId) {
                const client = clientsData.find(c => c.id === currentClientId);
                if (client) {
                    client.notes = document.getElementById('clientNotes').value;
                    alert('Заметки сохранены');
                    closeModal();
                }
            }
        }

        function filterClients() {
            const searchTerm = document.getElementById('clientSearch').value.toLowerCase();
            const filtered = clientsData.filter(client => 
                client.name.toLowerCase().includes(searchTerm) || 
                client.phone.toLowerCase().includes(searchTerm)
            );
            renderClients(filtered);
        }

        // ===== РАЗДЕЛ "ГАЛЕРЕЯ" =====
        function renderGalleryButtons() {
            const container = document.getElementById('galleryButtons');
            container.innerHTML = '';
            
            galleryData.forEach(building => {
                const button = document.createElement('button');
                button.className = 'gallery-button';
                button.textContent = building.name;
                
                button.addEventListener('click', () => showGalleryContent(building));
                container.appendChild(button);
            });
        }

        function showGalleryContent(building) {
            currentGalleryBuilding = building.id;
            document.getElementById('galleryButtons').style.display = 'none';
            document.getElementById('galleryContent').style.display = 'block';
            document.getElementById('galleryBuildingTitle').textContent = building.name;
            
            const mediaContainer = document.getElementById('mediaContainer');
            mediaContainer.innerHTML = '';
            
            building.media.forEach(item => {
                const mediaItem = document.createElement('div');
                mediaItem.className = 'media-item';
                
                if (item.type === 'image') {
                    mediaItem.innerHTML = `
                        <img src="${item.url}" alt="${item.title}">
                        <div class="media-title">${item.title}</div>
                    `;
                } else if (item.type === 'video') {
                    mediaItem.innerHTML = `
                        <video controls>
                            <source src="${item.url}" type="video/mp4">
                            Ваш браузер не поддерживает видео.
                        </video>
                        <div class="media-title">${item.title}</div>
                    `;
                }
                
                mediaContainer.appendChild(mediaItem);
            });
        }

        function hideGalleryContent() {
            document.getElementById('galleryContent').style.display = 'none';
            document.getElementById('galleryButtons').style.display = 'grid';
        }

        // Инициализация
        document.addEventListener('DOMContentLoaded', () => {
            showMainMenu();
            
            // Закрытие модального окна при клике вне его
            window.addEventListener('click', (event) => {
                const modal = document.getElementById('clientModal');
                if (event.target === modal) {
                    closeModal();
                }
            });
        });
    </script>
</body>
</html>
